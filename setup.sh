for cluster in $(aws eks list-clusters --region eu-central-1 --query 'clusters[]' --output text); do for ng in $(aws eks list-nodegroups --cluster-name $cluster --region eu-central-1 --query 'nodegroups[]' --output text); do aws eks delete-nodegroup --cluster-name $cluster --nodegroup-name $ng --region eu-central-1 >/dev/null 2>&1; done; aws eks delete-cluster --name $cluster --region eu-central-1 >/dev/null 2>&1; done

# Usuń wszystkie IAM role związane z klastrem "test"
for role in test-cluster-role test-node-role; do echo "Deleting role: $role"; for policy in $(aws iam list-attached-role-policies --role-name $role --query 'AttachedPolicies[].PolicyArn' --output text 2>/dev/null || echo ""); do aws iam detach-role-policy --role-name $role --policy-arn $policy 2>/dev/null || true; done; aws iam delete-role --role-name $role 2>/dev/null || true; done